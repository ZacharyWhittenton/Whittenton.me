<section class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8" role="region" aria-label="Blog">
    <h1 class="text-3xl font-bold tracking-tight mb-6">Blog</h1>
  
    <!-- Toolbar -->
    <div class="flex flex-col sm:flex-row gap-3 sm:items-center sm:justify-between mb-6">
      <!-- Search -->
      <label class="w-full sm:max-w-md">
        <span class="sr-only">Search posts</span>
        <input
          type="search"
          class="w-full rounded-2xl border border-gray-200 bg-white px-4 py-2 outline-none focus:ring-2 focus:ring-blue-500"
          placeholder="Search by title, excerpt, or author…"
          [ngModel]="query"
          (ngModelChange)="onSearch($event)"
          inputmode="search"
          aria-label="Search posts"
        />
      </label>
  
      <!-- Filters + Sort -->
      <div class="flex flex-wrap items-center gap-2">
        <!-- Tags -->
        <div *ngIf="availableTags.length" class="flex flex-wrap gap-2" aria-label="Filter by tags">
          <button
            type="button"
            *ngFor="let tag of availableTags"
            (click)="toggleTag(tag)"
            class="px-3 py-1 rounded-full border transition shadow-sm"
            [class.bg-blue-600]="selectedTags.includes(tag)"
            [class.text-white]="selectedTags.includes(tag)"
            [class.border-blue-600]="selectedTags.includes(tag)"
            [attr.aria-pressed]="selectedTags.includes(tag)"
          >
            #{{ tag }}
          </button>
        </div>
  
        <!-- Sort -->
        <label class="inline-flex items-center gap-2">
          <span class="text-sm text-gray-600">Sort</span>
          <select
            class="rounded-xl border border-gray-200 bg-white px-3 py-2 focus:ring-2 focus:ring-blue-500"
            [ngModel]="sort"
            (ngModelChange)="onSortChange($event)"
            aria-label="Sort posts"
          >
            <option value="date_desc">Newest</option>
            <option value="date_asc">Oldest</option>
            <option value="title_asc">Title A–Z</option>
            <option value="title_desc">Title Z–A</option>
          </select>
        </label>
      </div>
    </div>
  
    <!-- Loading -->
    <ng-container *ngIf="loading">
      <ul class="grid gap-6 md:grid-cols-2" aria-busy="true" aria-live="polite">
        <li *ngFor="let s of [1,2,3,4]" class="rounded-2xl border border-gray-200 bg-white p-6 shadow-sm">
          <div class="h-6 w-2/3 rounded bg-gray-200 mb-3"></div>
          <div class="h-4 w-1/3 rounded bg-gray-200 mb-4"></div>
          <div class="h-4 w-full rounded bg-gray-200 mb-2"></div>
          <div class="h-4 w-5/6 rounded bg-gray-200 mb-2"></div>
          <div class="h-4 w-2/3 rounded bg-gray-200"></div>
        </li>
      </ul>
    </ng-container>
  
    <!-- Error -->
    <div *ngIf="!loading && error" class="rounded-2xl border border-red-200 bg-red-50 p-4 text-red-800">
      <p class="font-medium">We couldn’t load posts.</p>
      <p class="text-sm">Please try again or refresh the page.</p>
      <button type="button" (click)="reload()" class="mt-3 inline-flex rounded-xl border px-3 py-2 hover:bg-red-100">
        Retry
      </button>
    </div>
  
    <!-- Posts -->
    <ng-container *ngIf="!loading && !error">
      <ul *ngIf="pagedPosts.length; else emptyState" class="grid gap-6 md:grid-cols-2" aria-live="polite">
        <li *ngFor="let post of pagedPosts">
          <article class="h-full rounded-2xl border border-gray-200 bg-white p-6 shadow-sm transition hover:shadow-md">
            <header class="mb-3">
              <h2 class="text-xl font-semibold leading-snug">
                <a
                  [routerLink]="['/blog', post.slug || post.id]"
                  class="hover:underline"
                  [attr.aria-label]="'Read ' + post.title"
                >
                  {{ post.title }}
                </a>
              </h2>
              <p class="mt-1 text-sm text-gray-600">
                {{ post.author }} •
                <time [attr.datetime]="(post.date | date:'yyyy-MM-dd')">
                  {{ post.date | date:'mediumDate' }}
                </time>
                <ng-container *ngIf="post.readMinutes"> • {{ post.readMinutes }} min read</ng-container>
              </p>
            </header>
  
            <p class="text-gray-800 mb-4 line-clamp-3">
              {{ post.excerpt }}
            </p>
  
            <div *ngIf="post.tags?.length" class="mb-4 flex flex-wrap gap-2">
              <span *ngFor="let t of post.tags" class="rounded-full bg-gray-100 px-3 py-1 text-xs text-gray-700">
                #{{ t }}
              </span>
            </div>
  
            <footer class="mt-auto">
              <a
                [routerLink]="['/blog', post.slug || post.id]"
                class="inline-flex items-center gap-1 rounded-xl border border-blue-600 px-3 py-2 text-blue-700 hover:bg-blue-50"
              >
                Read more <span aria-hidden="true">→</span>
              </a>
            </footer>
          </article>
        </li>
      </ul>
  
      <!-- Empty -->
      <ng-template #emptyState>
        <div class="rounded-2xl border border-gray-200 p-10 text-center">
          <p class="text-gray-700 mb-2 font-medium">No posts match your filters.</p>
          <p class="text-gray-500 text-sm">Try clearing search or tags.</p>
          <button type="button" (click)="clearFilters()" class="mt-4 rounded-xl border px-3 py-2 hover:bg-gray-50">
            Clear filters
          </button>
        </div>
      </ng-template>
    </ng-container>
  
    <!-- Pagination -->
    <nav *ngIf="!loading && totalPages > 1" class="mt-8 flex items-center justify-between" role="navigation" aria-label="Pagination">
      <button
        type="button"
        class="rounded-xl border px-3 py-2 disabled:opacity-50"
        [disabled]="page === 1"
        (click)="goToPage(page - 1)"
        aria-label="Previous page"
      >
        ← Prev
      </button>
      <p class="text-sm text-gray-600">Page {{ page }} of {{ totalPages }}</p>
      <button
        type="button"
        class="rounded-xl border px-3 py-2 disabled:opacity-50"
        [disabled]="page === totalPages"
        (click)="goToPage(page + 1)"
        aria-label="Next page"
      >
        Next →
      </button>
    </nav>
  </section>
  