{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../../services/blog.service\";\nimport * as i3 from \"@angular/router\";\nexport class BlogEditorComponent {\n  constructor(fb, blogService, route, router) {\n    this.fb = fb;\n    this.blogService = blogService;\n    this.route = route;\n    this.router = router;\n    // Strongly typed, non‑nullable form\n    this.postForm = this.fb.group({\n      title: ['', Validators.required],\n      content: ['', Validators.required]\n    });\n    this.editing = false;\n    this.postId = null;\n    this.saving = false;\n  }\n  ngOnInit() {\n    const idParam = this.route.snapshot.paramMap.get('id');\n    if (!idParam) return;\n    const parsedId = Number(idParam);\n    if (Number.isNaN(parsedId)) {\n      // Bad id in URL; bail out to list.\n      this.router.navigate(['/blog']);\n      return;\n    }\n    this.editing = true;\n    this.postId = parsedId;\n    this.blogService.get(this.postId).subscribe({\n      next: post => {\n        if (!post) {\n          this.router.navigate(['/blog']);\n          return;\n        }\n        // Defensive: ensure strings when patching\n        this.postForm.patchValue({\n          title: post.title ?? '',\n          content: post.content ?? ''\n        });\n      },\n      error: () => this.router.navigate(['/blog'])\n    });\n  }\n  onSubmit() {\n    if (this.postForm.invalid || this.saving) return;\n    this.saving = true;\n    const dto = this.postForm.getRawValue(); // non-nullable values\n    const req$ = this.editing && this.postId !== null ? this.blogService.update(this.postId, dto) : this.blogService.create(dto);\n    req$.subscribe({\n      next: () => this.router.navigate(['/blog']),\n      error: () => {\n        // Keep the form enabled for retry\n        this.saving = false;\n      }\n    });\n  }\n  static {\n    this.ɵfac = function BlogEditorComponent_Factory(t) {\n      return new (t || BlogEditorComponent)(i0.ɵɵdirectiveInject(i1.NonNullableFormBuilder), i0.ɵɵdirectiveInject(i2.BlogService), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i3.Router));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: BlogEditorComponent,\n      selectors: [[\"app-blog-editor\"]],\n      decls: 14,\n      vars: 3,\n      consts: [[1, \"max-w-2xl\", \"mx-auto\", \"mt-10\", \"p-6\", \"bg-white\", \"rounded\", \"shadow\", \"space-y-4\"], [1, \"text-2xl\", \"font-bold\"], [1, \"space-y-4\", 3, \"ngSubmit\", \"formGroup\"], [\"formControlName\", \"title\", 1, \"w-full\", \"border\", \"p-2\", \"rounded\"], [\"formControlName\", \"content\", \"rows\", \"6\", 1, \"w-full\", \"border\", \"p-2\", \"rounded\"], [1, \"bg-blue-600\", \"text-white\", \"px-4\", \"py-2\", \"rounded\", \"hover:bg-blue-700\"]],\n      template: function BlogEditorComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\", 1);\n          i0.ɵɵtext(2);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"form\", 2);\n          i0.ɵɵlistener(\"ngSubmit\", function BlogEditorComponent_Template_form_ngSubmit_3_listener() {\n            return ctx.onSubmit();\n          });\n          i0.ɵɵelementStart(4, \"div\")(5, \"label\");\n          i0.ɵɵtext(6, \"Title\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(7, \"input\", 3);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(8, \"div\")(9, \"label\");\n          i0.ɵɵtext(10, \"Content\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(11, \"textarea\", 4);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(12, \"button\", 5);\n          i0.ɵɵtext(13);\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(2);\n          i0.ɵɵtextInterpolate(ctx.editing ? \"Edit Post\" : \"Create Post\");\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"formGroup\", ctx.postForm);\n          i0.ɵɵadvance(10);\n          i0.ɵɵtextInterpolate1(\" \", ctx.editing ? \"Update\" : \"Create\", \" \");\n        }\n      },\n      dependencies: [i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName],\n      encapsulation: 2\n    });\n  }\n}","map":{"version":3,"names":["Validators","BlogEditorComponent","constructor","fb","blogService","route","router","postForm","group","title","required","content","editing","postId","saving","ngOnInit","idParam","snapshot","paramMap","get","parsedId","Number","isNaN","navigate","subscribe","next","post","patchValue","error","onSubmit","invalid","dto","getRawValue","req$","update","create","i0","ɵɵdirectiveInject","i1","NonNullableFormBuilder","i2","BlogService","i3","ActivatedRoute","Router","selectors","decls","vars","consts","template","BlogEditorComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","BlogEditorComponent_Template_form_ngSubmit_3_listener","ɵɵelement","ɵɵadvance","ɵɵtextInterpolate","ɵɵproperty","ɵɵtextInterpolate1"],"sources":["/Users/zaq/Documents/GitHub/Angular-APWU/src/app/features/blog/components/blog-editor/blog-editor.component.ts","/Users/zaq/Documents/GitHub/Angular-APWU/src/app/features/blog/components/blog-editor/blog-editor.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { NonNullableFormBuilder, Validators } from '@angular/forms';\nimport { BlogService } from '../../services/blog.service';\n\ninterface BlogPostDto {\n  title: string;\n  content: string;\n}\n\n@Component({\n  selector: 'app-blog-editor',\n  templateUrl: './blog-editor.component.html'\n})\nexport class BlogEditorComponent implements OnInit {\n  // Strongly typed, non‑nullable form\n  readonly postForm = this.fb.group({\n    title: ['', Validators.required],\n    content: ['', Validators.required]\n  });\n\n  editing = false;\n  postId: number | null = null;\n  saving = false;\n\n  constructor(\n    private fb: NonNullableFormBuilder,\n    private blogService: BlogService,\n    private route: ActivatedRoute,\n    private router: Router\n  ) {}\n\n  ngOnInit(): void {\n    const idParam = this.route.snapshot.paramMap.get('id');\n    if (!idParam) return;\n\n    const parsedId = Number(idParam);\n    if (Number.isNaN(parsedId)) {\n      // Bad id in URL; bail out to list.\n      this.router.navigate(['/blog']);\n      return;\n    }\n\n    this.editing = true;\n    this.postId = parsedId;\n\n    this.blogService.get(this.postId).subscribe({\n      next: (post) => {\n        if (!post) {\n          this.router.navigate(['/blog']);\n          return;\n        }\n\n        // Defensive: ensure strings when patching\n        this.postForm.patchValue({\n          title: post.title ?? '',\n          content: post.content ?? ''\n        });\n      },\n      error: () => this.router.navigate(['/blog'])\n    });\n  }\n\n  onSubmit(): void {\n    if (this.postForm.invalid || this.saving) return;\n\n    this.saving = true;\n    const dto: BlogPostDto = this.postForm.getRawValue(); // non-nullable values\n\n    const req$ =\n      this.editing && this.postId !== null\n        ? this.blogService.update(this.postId, dto)\n        : this.blogService.create(dto);\n\n    req$.subscribe({\n      next: () => this.router.navigate(['/blog']),\n      error: () => {\n        // Keep the form enabled for retry\n        this.saving = false;\n      }\n    });\n  }\n}\n","<div class=\"max-w-2xl mx-auto mt-10 p-6 bg-white rounded shadow space-y-4\">\n  <h2 class=\"text-2xl font-bold\">{{ editing ? 'Edit Post' : 'Create Post' }}</h2>\n\n  <form [formGroup]=\"postForm\" (ngSubmit)=\"onSubmit()\" class=\"space-y-4\">\n    <div>\n      <label>Title</label>\n      <input formControlName=\"title\" class=\"w-full border p-2 rounded\" />\n    </div>\n\n    <div>\n      <label>Content</label>\n      <textarea formControlName=\"content\" rows=\"6\" class=\"w-full border p-2 rounded\"></textarea>\n    </div>\n\n    <button class=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700\">\n      {{ editing ? 'Update' : 'Create' }}\n    </button>\n  </form>\n</div>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}